<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon_200x200.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon_32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_16x16.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="/lib/pace/pace-theme-material.min.css"><script src="/lib/pace/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"tanwucheng.github.io",root:"/",scheme:"Mist",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!0},copycode:{enable:!0,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:"valine",storage:!0,lazyload:!1,nav:null,activeClass:"valine"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="此示例不借助hexo-service-worker、hexo-offline和hexo-pwa等插件实现，自己编写 manifest.webmanifest(menifest.json)和 serviceWorker.js 并引入页面如果使用上述插件，可以参考此博文 编写 manifest.json Web App Manifest说明文档参考MDN manifest.json简易生成器Web A"><meta property="og:type" content="article"><meta property="og:title" content="HEXO笔记②-Hexo博客添加PWA支持"><meta property="og:url" content="https://tanwucheng.github.io/2021/03/02/2.Hexo%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0PWA%E6%94%AF%E6%8C%81/index.html"><meta property="og:site_name" content="Ten&#39;s Blog"><meta property="og:description" content="此示例不借助hexo-service-worker、hexo-offline和hexo-pwa等插件实现，自己编写 manifest.webmanifest(menifest.json)和 serviceWorker.js 并引入页面如果使用上述插件，可以参考此博文 编写 manifest.json Web App Manifest说明文档参考MDN manifest.json简易生成器Web A"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2021-03-02T08:53:28.000Z"><meta property="article:modified_time" content="2021-03-24T14:42:27.305Z"><meta property="article:author" content="Ten"><meta property="article:tag" content="笔记"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://tanwucheng.github.io/2021/03/02/2.Hexo%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0PWA%E6%94%AF%E6%8C%81/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>HEXO笔记②-Hexo博客添加PWA支持 | Ten's Blog</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="manifest" href="/manifest.json"><link rel="alternate" href="/atom.xml" title="Ten's Blog" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Ten's Blog</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">.NET Developer</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i> 首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/tanwucheng" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://tanwucheng.github.io/2021/03/02/2.Hexo%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0PWA%E6%94%AF%E6%8C%81/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/umr.jpg"><meta itemprop="name" content="Ten"><meta itemprop="description" content="Ten的个人博客，分享一些心得"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Ten's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> HEXO笔记②-Hexo博客添加PWA支持</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-03-02 16:53:28" itemprop="dateCreated datePublished" datetime="2021-03-02T16:53:28+08:00">2021-03-02</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2021-03-24 22:42:27" itemprop="dateModified" datetime="2021-03-24T22:42:27+08:00">2021-03-24</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HEXO/" itemprop="url" rel="index"><span itemprop="name">HEXO</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HEXO/PWA/" itemprop="url" rel="index"><span itemprop="name">PWA</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Valine：</span><a title="valine" href="/2021/03/02/2.Hexo%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0PWA%E6%94%AF%E6%8C%81/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/2021/03/02/2.Hexo%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0PWA%E6%94%AF%E6%8C%81/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>6k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span>11 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="此示例不借助hexo-service-worker、hexo-offline和hexo-pwa等插件实现，自己编写-manifest-webmanifest-menifest-json-和-serviceWorker-js-并引入页面"><a href="#此示例不借助hexo-service-worker、hexo-offline和hexo-pwa等插件实现，自己编写-manifest-webmanifest-menifest-json-和-serviceWorker-js-并引入页面" class="headerlink" title="此示例不借助hexo-service-worker、hexo-offline和hexo-pwa等插件实现，自己编写 manifest.webmanifest(menifest.json)和 serviceWorker.js 并引入页面"></a>此示例不借助<a target="_blank" rel="noopener" href="https://github.com/zoumiaojiang/hexo-service-worker">hexo-service-worker</a>、<a target="_blank" rel="noopener" href="https://github.com/JLHwung/hexo-offline">hexo-offline</a>和<a target="_blank" rel="noopener" href="https://github.com/lavas-project/hexo-pwa">hexo-pwa</a>等插件实现，自己编写 manifest.webmanifest(menifest.json)和 serviceWorker.js 并引入页面</h2><p>如果使用上述插件，可以参考<a target="_blank" rel="noopener" href="https://linwhitehat.github.io/Blog/2020/02/09/Hexo%E5%8D%9A%E5%AE%A2%E9%83%A8%E7%BD%B2PWA.html">此博文</a></p><h3 id="编写-manifest-json"><a href="#编写-manifest-json" class="headerlink" title="编写 manifest.json"></a>编写 manifest.json</h3><ol><li><strong>Web App Manifest</strong>说明文档参考<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/Manifest">MDN</a></li><li><strong>manifest.json</strong>简易生成器<a target="_blank" rel="noopener" href="https://app-manifest.firebaseapp.com/">Web App Manifest Generator</a></li><li>如果不使用主题，把生成的<strong>manifest.json</strong>放置在项目<strong>source</strong>文件夹根目录，<strong>hexo</strong>发布时会放置在发布文件夹根目录(跟<strong>index.html</strong>同一级目录)</li><li>如果使用主题，比如<strong>NexT</strong>主题放在./themes/next，则把<strong>manifest.json</strong>放置在./themes/next/source/目录下</li></ol><span id="more"></span><h3 id="编写一个-Service-Worker-管理器-js，用于管理-Service-Worker-的安装、更新、卸载以及-Service-Worker-的同步、通知、Web-推送等任务"><a href="#编写一个-Service-Worker-管理器-js，用于管理-Service-Worker-的安装、更新、卸载以及-Service-Worker-的同步、通知、Web-推送等任务" class="headerlink" title="编写一个 Service Worker 管理器 js，用于管理 Service Worker 的安装、更新、卸载以及 Service Worker 的同步、通知、Web 推送等任务"></a>编写一个 Service Worker 管理器 js，用于管理 Service Worker 的安装、更新、卸载以及 Service Worker 的同步、通知、Web 推送等任务</h3><p><strong>sw.reg.mgr.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册Service Worker</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>config 配置项目</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">const</span> register = <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//浏览器是否支持</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;serviceWorker&quot;</span> <span class="keyword">in</span> navigator) &#123;</span><br><span class="line">            <span class="keyword">let</span> swUrl = <span class="string">`<span class="subst">$&#123;config.path&#125;</span>/<span class="subst">$&#123;config.name&#125;</span>?v=<span class="subst">$&#123;config.ver&#125;</span>`</span>;</span><br><span class="line">            <span class="comment">// 通过ver的变化来强制进行更新操作，每次更新sw.js时进行ver+1操作</span></span><br><span class="line">            navigator.serviceWorker</span><br><span class="line">                .register(swUrl)</span><br><span class="line">                .then(<span class="function">(<span class="params">swReg</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">&quot;Service Worker注册成功&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (config &amp;&amp; config.onRegister) &#123;</span><br><span class="line">                        config.onRegister(swReg);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    swReg.onupdatefound = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">let</span> installingWorker = swReg.installing;</span><br><span class="line">                        <span class="keyword">if</span> (!installingWorker) &#123;</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        installingWorker.onstatechange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span> (installingWorker.state === <span class="string">&quot;installed&quot;</span>) &#123;</span><br><span class="line">                                <span class="keyword">if</span> (navigator.serviceWorker.controller) &#123;</span><br><span class="line">                                    config.log &amp;&amp;</span><br><span class="line">                                        <span class="built_in">console</span>.log(<span class="string">&quot;Service Worker已安装更新&quot;</span>);</span><br><span class="line">                                    <span class="keyword">if</span> (config &amp;&amp; config.onUpdate) &#123;</span><br><span class="line">                                        config.onUpdate(swReg);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                    config.log &amp;&amp;</span><br><span class="line">                                        <span class="built_in">console</span>.log(<span class="string">&quot;Service Worker已安装&quot;</span>);</span><br><span class="line">                                    <span class="keyword">if</span> (config &amp;&amp; config.onSuccess) &#123;</span><br><span class="line">                                        config.onSuccess(swReg);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;)</span><br><span class="line">                .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (config &amp;&amp; config.onError) &#123;</span><br><span class="line">                        config.onError(err);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="built_in">console</span>.error(<span class="string">&quot;Service Worker注册期间发生错误:&quot;</span>, err);</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (navigator.serviceWorker.controller) &#123;</span><br><span class="line">                navigator.serviceWorker.controller.postMessage(</span><br><span class="line">                    <span class="string">&quot;这是从window环境postMessage()&quot;</span></span><br><span class="line">                );</span><br><span class="line"></span><br><span class="line">                <span class="keyword">const</span> channel = <span class="keyword">new</span> MessageChannel();</span><br><span class="line">                channel.port1.onmessage = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(</span><br><span class="line">                        <span class="string">`<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleString()&#125;</span>, index.html port1收到消息:<span class="subst">$&#123;</span></span></span><br><span class="line"><span class="string"><span class="subst">                            e.data</span></span></span><br><span class="line"><span class="string"><span class="subst">                        &#125;</span>`</span></span><br><span class="line">                    );</span><br><span class="line">                &#125;;</span><br><span class="line">                <span class="comment">// 向port2发送消息</span></span><br><span class="line">                navigator.serviceWorker.controller.postMessage(</span><br><span class="line">                    <span class="string">&quot;这是index.html向port2 postMessage()&quot;</span>,</span><br><span class="line">                    [channel.port2]</span><br><span class="line">                );</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            navigator.serviceWorker.onmessage = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(</span><br><span class="line">                    <span class="string">`<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleString()&#125;</span>, index.html收到的消息: <span class="subst">$&#123;</span></span></span><br><span class="line"><span class="string"><span class="subst">                        e.data</span></span></span><br><span class="line"><span class="string"><span class="subst">                    &#125;</span>`</span></span><br><span class="line">                );</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注销Service Worker</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">const</span> unregister = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;serviceWorker&quot;</span> <span class="keyword">in</span> navigator) &#123;</span><br><span class="line">            navigator.serviceWorker.ready.then(<span class="function">(<span class="params">swReg</span>) =&gt;</span> &#123;</span><br><span class="line">                swReg.unregister(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">                    result &amp;&amp; <span class="built_in">console</span>.log(<span class="string">&quot;Service Worker注销成功&quot;</span>);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> broad = <span class="keyword">new</span> BroadcastChannel(<span class="string">&quot;c1&quot;</span>);</span><br><span class="line">    broad.onmessage = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(</span><br><span class="line">            <span class="string">`<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleString()&#125;</span>, index.html收到的Service Worker广播消息:<span class="subst">$&#123;</span></span></span><br><span class="line"><span class="string"><span class="subst">                e.data</span></span></span><br><span class="line"><span class="string"><span class="subst">            &#125;</span>`</span></span><br><span class="line">        );</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注册sw.js</span></span><br><span class="line">    register(&#123;</span><br><span class="line">        ver: <span class="number">1</span>,</span><br><span class="line">        path: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        name: <span class="string">&quot;sw.js&quot;</span>,</span><br><span class="line">        log: <span class="literal">true</span>,</span><br><span class="line">        onRegister: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">        onSuccess: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">        onUpdate: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">        onError: <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;&#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h3 id="编写-Service-Worker-文件，这里借助谷歌Workbox帮助编写和管理-Service-Worker"><a href="#编写-Service-Worker-文件，这里借助谷歌Workbox帮助编写和管理-Service-Worker" class="headerlink" title="编写 Service Worker 文件，这里借助谷歌Workbox帮助编写和管理 Service Worker"></a>编写 Service Worker 文件，这里借助谷歌<a target="_blank" rel="noopener" href="https://developers.google.cn/web/tools/workbox/guides/get-started?hl=zh-cn">Workbox</a>帮助编写和管理 Service Worker</h3><p><strong>Service Worker</strong>详细说明参照<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/Service_Worker_API">MDN</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">importScripts(<span class="string">&quot;https://g.alicdn.com/kg/workbox/3.3.0/workbox-sw.js&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (workbox) &#123;</span><br><span class="line">    workbox.setConfig(&#123;</span><br><span class="line">        modulePathPrefix: <span class="string">&quot;https://g.alicdn.com/kg/workbox/3.3.0/&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 修改默认配置</span></span><br><span class="line">    workbox.core.setCacheNameDetails(&#123;</span><br><span class="line">        prefix: <span class="string">&quot;TenBlog&quot;</span>,</span><br><span class="line">        suffix: <span class="string">&quot;v1&quot;</span>,</span><br><span class="line">        precache: <span class="string">&quot;precache&quot;</span>,</span><br><span class="line">        runtime: <span class="string">&quot;runtime&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 预先缓存资源</span></span><br><span class="line">    workbox.precaching.precache([</span><br><span class="line">        <span class="string">&quot;/&quot;</span>,</span><br><span class="line">        <span class="string">&quot;/index.html&quot;</span>,</span><br><span class="line">        <span class="string">&quot;/404.html&quot;</span>,</span><br><span class="line">        <span class="string">&quot;/offline.html&quot;</span>,</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从缓存中读取资源的同时发送网络请求更新本地缓存</span></span><br><span class="line">    workbox.routing.registerRoute(</span><br><span class="line">        <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;^https?://tanwucheng.github.io/?$&quot;</span>),</span><br><span class="line">        workbox.strategies.staleWhileRevalidate()</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 网络优先</span></span><br><span class="line">    workbox.routing.registerRoute(</span><br><span class="line">        <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;.*.html&quot;</span>),</span><br><span class="line">        workbox.strategies.networkFirst()</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 缓存优先</span></span><br><span class="line">    workbox.routing.registerRoute(</span><br><span class="line">        <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;.*.(?:js|css|jpg|png|gif)&quot;</span>),</span><br><span class="line">        workbox.strategies.cacheFirst()</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Handling Offline Page fallback</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="built_in">this</span>.addEventListener(<span class="string">&quot;fetch&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">            event.request.mode === <span class="string">&quot;navigate&quot;</span> ||</span><br><span class="line">            (event.request.method === <span class="string">&quot;GET&quot;</span> &amp;&amp;</span><br><span class="line">                event.request.headers.get(<span class="string">&quot;accept&quot;</span>).includes(<span class="string">&quot;text/html&quot;</span>))</span><br><span class="line">        ) &#123;</span><br><span class="line">            event.respondWith(</span><br><span class="line">                fetch(event.request.url).catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">&quot;fetch error&quot;</span>, error);</span><br><span class="line">                    <span class="comment">// Return the offline page</span></span><br><span class="line">                    <span class="keyword">return</span> caches.match(<span class="string">&quot;/offline.html&quot;</span>);</span><br><span class="line">                &#125;)</span><br><span class="line">            );</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Respond with everything else if we can</span></span><br><span class="line">            event.respondWith(</span><br><span class="line">                caches.match(event.request).then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> response || fetch(event.request);</span><br><span class="line">                &#125;)</span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Service-Worker-文件-sw-js-和-Service-Worker-sw-reg-mgr-jd-管理器放在跟-manifest-json-同一级目录"><a href="#Service-Worker-文件-sw-js-和-Service-Worker-sw-reg-mgr-jd-管理器放在跟-manifest-json-同一级目录" class="headerlink" title="Service Worker 文件(sw.js)和 Service Worker(sw.reg.mgr.jd)管理器放在跟 manifest.json 同一级目录"></a>Service Worker 文件(sw.js)和 Service Worker(sw.reg.mgr.jd)管理器放在跟 manifest.json 同一级目录</h3><h3 id="页面引入-manifest-json-和-Service-Worker"><a href="#页面引入-manifest-json-和-Service-Worker" class="headerlink" title="页面引入 manifest.json 和 Service Worker"></a>页面引入 manifest.json 和 Service Worker</h3><ul><li><p> 如果不使用主题，则在运行<strong>hexo generate</strong>命令后到./public 文件夹下修改<strong>index.html</strong>，在&lt;head&gt; 节点结束前引入<strong>manifest.json</strong>，在 &lt;body&gt; 结束前引入<strong>Service Worker</strong>管理器代码，应该有更简便的方式，还在查找资料中</p></li><li><p> 如果使用主题，比如<strong>NexT</strong>主题放在./themes/next，则修改./themes/next/layout/_layout.swig 文件，在 &lt;head&gt; 节点结束前引入<strong>manifest.json</strong>，在 &lt;body&gt; 结束前引入<strong>Service Worker</strong>管理器代码</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Other code here--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;manifest&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/manifest.json&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Other code here--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">            (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">if</span> (<span class="built_in">window</span>.addEventListener) &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">window</span>.addEventListener(<span class="string">&quot;load&quot;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                        <span class="keyword">let</span> script = <span class="built_in">document</span>.createElement(<span class="string">&quot;script&quot;</span>);</span></span><br><span class="line"><span class="javascript">                        <span class="comment">// script.src = `/sw.reg.mgr.js?t=$&#123;new Date()&#125;`; // 无缓存引用</span></span></span><br><span class="line"><span class="javascript">                        script.src = <span class="string">`/sw.reg.mgr.js`</span>; <span class="comment">// 无缓存引用</span></span></span><br><span class="line"><span class="javascript">                        script.async = <span class="literal">true</span>;</span></span><br><span class="line"><span class="javascript">                        script.type = <span class="string">&quot;text/javascript&quot;</span>;</span></span><br><span class="line"><span class="javascript">                        script.crossOrigin = <span class="string">&quot;anonymous&quot;</span>;</span></span><br><span class="line"><span class="javascript">                        <span class="built_in">document</span>.head.insertBefore(</span></span><br><span class="line">                            script,</span><br><span class="line"><span class="javascript">                            <span class="built_in">document</span>.head.firstChild</span></span><br><span class="line">                        );</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)();</span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> Ten</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://tanwucheng.github.io/2021/03/02/2.Hexo%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0PWA%E6%94%AF%E6%8C%81/" title="HEXO笔记②-Hexo博客添加PWA支持">https://tanwucheng.github.io/2021/03/02/2.Hexo博客添加PWA支持/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag"><i class="fa fa-tag"></i> 笔记</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2021/03/01/1.Hexo%E5%AE%98%E6%96%B9%E5%BC%80%E7%AE%B1%E5%8D%B3%E7%94%A8%E6%95%99%E7%A8%8B/" rel="prev" title="HEXO笔记①-Hexo官方开箱即用教程"><i class="fa fa-chevron-left"></i> HEXO笔记①-Hexo官方开箱即用教程</a></div><div class="post-nav-item"> <a href="/2021/03/02/3.%E4%BD%BF%E7%94%A8Gulp%E5%8E%8B%E7%BC%A9%E5%8F%91%E5%B8%83%E7%9A%84%E6%96%87%E4%BB%B6/" rel="next" title="HEXO笔记③-使用Gulp压缩发布的文件">HEXO笔记③-使用Gulp压缩发布的文件<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A4%E7%A4%BA%E4%BE%8B%E4%B8%8D%E5%80%9F%E5%8A%A9hexo-service-worker%E3%80%81hexo-offline%E5%92%8Chexo-pwa%E7%AD%89%E6%8F%92%E4%BB%B6%E5%AE%9E%E7%8E%B0%EF%BC%8C%E8%87%AA%E5%B7%B1%E7%BC%96%E5%86%99-manifest-webmanifest-menifest-json-%E5%92%8C-serviceWorker-js-%E5%B9%B6%E5%BC%95%E5%85%A5%E9%A1%B5%E9%9D%A2"><span class="nav-number">1.</span> <span class="nav-text">此示例不借助hexo-service-worker、hexo-offline和hexo-pwa等插件实现，自己编写 manifest.webmanifest(menifest.json)和 serviceWorker.js 并引入页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99-manifest-json"><span class="nav-number">1.1.</span> <span class="nav-text">编写 manifest.json</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA-Service-Worker-%E7%AE%A1%E7%90%86%E5%99%A8-js%EF%BC%8C%E7%94%A8%E4%BA%8E%E7%AE%A1%E7%90%86-Service-Worker-%E7%9A%84%E5%AE%89%E8%A3%85%E3%80%81%E6%9B%B4%E6%96%B0%E3%80%81%E5%8D%B8%E8%BD%BD%E4%BB%A5%E5%8F%8A-Service-Worker-%E7%9A%84%E5%90%8C%E6%AD%A5%E3%80%81%E9%80%9A%E7%9F%A5%E3%80%81Web-%E6%8E%A8%E9%80%81%E7%AD%89%E4%BB%BB%E5%8A%A1"><span class="nav-number">1.2.</span> <span class="nav-text">编写一个 Service Worker 管理器 js，用于管理 Service Worker 的安装、更新、卸载以及 Service Worker 的同步、通知、Web 推送等任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99-Service-Worker-%E6%96%87%E4%BB%B6%EF%BC%8C%E8%BF%99%E9%87%8C%E5%80%9F%E5%8A%A9%E8%B0%B7%E6%AD%8CWorkbox%E5%B8%AE%E5%8A%A9%E7%BC%96%E5%86%99%E5%92%8C%E7%AE%A1%E7%90%86-Service-Worker"><span class="nav-number">1.3.</span> <span class="nav-text">编写 Service Worker 文件，这里借助谷歌Workbox帮助编写和管理 Service Worker</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Service-Worker-%E6%96%87%E4%BB%B6-sw-js-%E5%92%8C-Service-Worker-sw-reg-mgr-jd-%E7%AE%A1%E7%90%86%E5%99%A8%E6%94%BE%E5%9C%A8%E8%B7%9F-manifest-json-%E5%90%8C%E4%B8%80%E7%BA%A7%E7%9B%AE%E5%BD%95"><span class="nav-number">1.4.</span> <span class="nav-text">Service Worker 文件(sw.js)和 Service Worker(sw.reg.mgr.jd)管理器放在跟 manifest.json 同一级目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B5%E9%9D%A2%E5%BC%95%E5%85%A5-manifest-json-%E5%92%8C-Service-Worker"><span class="nav-number">1.5.</span> <span class="nav-text">页面引入 manifest.json 和 Service Worker</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ten" src="/images/umr.jpg"><p class="site-author-name" itemprop="name">Ten</p><div class="site-description" itemprop="description">Ten的个人博客，分享一些心得</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">14</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">7</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">5</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/tanwucheng" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;tanwucheng" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a></span><span class="links-of-author-item"><a href="mailto:tanwucheng@outlook.com" title="E-Mail → mailto:tanwucheng@outlook.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a></span><span class="links-of-author-item"><a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i></a></span><span class="links-of-author-item"><a href="https://github.com/TanWucheng/TenBlogClients/releases/tag/0.2.2-alpha" title="App → https:&#x2F;&#x2F;github.com&#x2F;TanWucheng&#x2F;TenBlogClients&#x2F;releases&#x2F;tag&#x2F;0.2.2-alpha" rel="noopener" target="_blank"><i class="fa fa-rocket fa-fw"></i></a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><script async src="//cdn.jsdelivr.net/gh/sukkaw/busuanzi@2.3/bsz.pure.mini.js"></script><div class="copyright"> &copy; <span itemprop="copyrightYear">2021</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ten</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span title="站点阅读时长">1:02</span></div><div class="powered-by"><i class="fa fa-user-md"></i> <span id="busuanzi_container_site_uv">本站访客数:<span id="busuanzi_value_site_uv"></span></span></div> <span class="post-meta-divider">|</span><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动</div><div class="addthis_inline_share_toolbox"><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-60406b6465bbcf3a" async="async"></script></div> <span class="post-meta-divider">|</span><div class="theme-info"><div class="powered-by"></div> <span class="post-count">博客全站共7.7k字</span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script defer="defer" src="/lib/three/three.min.js"></script><script defer="defer" src="/lib/three/three-waves.min.js"></script><script defer="defer" src="/lib/three/canvas_sphere.min.js"></script><script src="/js/local-search.js"></script><script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('https://cdn.jsdelivr.net/npm/valine', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'u3qNJ3qqlHG7WAu0Khkbmv9C-gzGzoHsz',
      appKey     : 'HHQvkavcTK28kAE1prXuOumQ',
      placeholder: "Just go go",
      avatar     : '/images/umr.jpg',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script><script src="/myUtils.js"></script><script type="module">
      (function () {
          if (window.addEventListener) {
              window.addEventListener("load", () => {
                  let script = document.createElement("script");
                  script.src = `/sw.reg.mgr.js`; // 无缓存引用
                  script.async = true;
                  script.type = "text/javascript";
                  script.crossOrigin = "anonymous";
                  document.head.insertBefore(
                      script,
                      document.head.firstChild
                  );
              });
          }
      })();
  </script></body></html>